L.Control.Sidebar=L.Control.extend({includes:L.Evented?L.Evented.prototype:L.Mixin.Events,options:{autopan:!1,closeButton:!0,id:"",position:"left"},initialize:function(t,i){return"string"==typeof t&&(console.warn("this syntax is deprecated. please use L.control.sidebar({ id }) now"),t={id:t}),this._tabitems=[],this._panes=[],this._closeButtons=[],L.setOptions(this,Object.assign({},t,i)),this},onAdd:function(t){var i,e,s,a,o;for(o=L.DomUtil.get(this.options.id),null==o&&(o=L.DomUtil.create("div","sidebar collapsed")),this._paneContainer=o.querySelector("div.sidebar-content"),null===this._paneContainer&&(this._paneContainer=L.DomUtil.create("div","sidebar-content",o)),s=o.querySelectorAll("ul.sidebar-tabs, div.sidebar-tabs > ul"),this._tabContainerTop=s[0]||null,this._tabContainerBottom=s[1]||null,null===this._tabContainerTop&&(a=L.DomUtil.create("div","sidebar-tabs",o),a.setAttribute("role","tablist"),this._tabContainerTop=L.DomUtil.create("ul","",a)),null===this._tabContainerBottom&&(a=this._tabContainerTop.parentNode,this._tabContainerBottom=L.DomUtil.create("ul","",a)),i=0;i<this._tabContainerTop.children.length;i++)e=this._tabContainerTop.children[i],e._sidebar=this,e._id=e.querySelector("a").hash.slice(1),this._tabitems.push(e);for(i=0;i<this._tabContainerBottom.children.length;i++)e=this._tabContainerBottom.children[i],e._sidebar=this,e._id=e.querySelector("a").hash.slice(1),this._tabitems.push(e);for(i=0;i<this._paneContainer.children.length;i++)if(e=this._paneContainer.children[i],"DIV"===e.tagName&&L.DomUtil.hasClass(e,"sidebar-pane")){this._panes.push(e);var n=e.querySelectorAll(".sidebar-close");n.length&&(this._closeButtons.push(n[n.length-1]),this._closeClick(n[n.length-1],"on"))}for(i=0;i<this._tabitems.length;i++)this._tabClick(this._tabitems[i],"on");return o},onRemove:function(t){var i;for(this._map=null,this._tabitems=[],this._panes=[],this._closeButtons=[],i=0;i<this._tabitems.length-1;i++)this._tabClick(this._tabitems[i],"off");for(i=0;i<this._closeButtons.length;i++)this._closeClick(this._closeButtons[i],"off");return this},addTo:function(t){return this.onRemove(),this._map=t,this._sidebar=this.onAdd(t),L.DomUtil.addClass(this._sidebar,"leaflet-control"),L.DomUtil.addClass(this._sidebar,"sidebar-"+this.getPosition()),L.Browser.touch&&L.DomUtil.addClass(this._sidebar,"leaflet-touch"),L.DomEvent.disableScrollPropagation(this._sidebar),L.DomEvent.disableClickPropagation(this._sidebar),t._container.insertBefore(this._sidebar,t._container.firstChild),this},removeFrom:function(t){console.log("removeFrom() has been deprecated, please use remove() instead as support for this function will be ending soon."),this.onRemove(t)},open:function(t){var i,e,s;if(s=this._getTab(t),L.DomUtil.hasClass(s,"disabled"))return this;for(i=0;i<this._panes.length;i++)e=this._panes[i],e.id===t?L.DomUtil.addClass(e,"active"):L.DomUtil.hasClass(e,"active")&&L.DomUtil.removeClass(e,"active");for(i=0;i<this._tabitems.length;i++)e=this._tabitems[i],e.querySelector("a").hash==="#"+t?L.DomUtil.addClass(e,"active"):L.DomUtil.hasClass(e,"active")&&L.DomUtil.removeClass(e,"active");return this.fire("content",{id:t}),L.DomUtil.hasClass(this._sidebar,"collapsed")&&(this.fire("opening"),L.DomUtil.removeClass(this._sidebar,"collapsed"),this.options.autopan&&this._panMap("open")),this},close:function(){var t;for(t=0;t<this._tabitems.length;t++){var i=this._tabitems[t];L.DomUtil.hasClass(i,"active")&&L.DomUtil.removeClass(i,"active")}return L.DomUtil.hasClass(this._sidebar,"collapsed")||(this.fire("closing"),L.DomUtil.addClass(this._sidebar,"collapsed"),this.options.autopan&&this._panMap("close")),this},addPanel:function(t){var i,e,s,a,o;return e=L.DomUtil.create("li",t.disabled?"disabled":""),s=L.DomUtil.create("a","",e),s.href="#"+t.id,s.setAttribute("role","tab"),s.innerHTML=t.tab,e._sidebar=this,e._id=t.id,e._button=t.button,t.title&&"<"!==t.title[0]&&(e.title=t.title),"bottom"===t.position?this._tabContainerBottom.appendChild(e):this._tabContainerTop.appendChild(e),this._tabitems.push(e),t.pane&&("string"==typeof t.pane?(i=L.DomUtil.create("DIV","sidebar-pane",this._paneContainer),o="",t.title&&(o+='<h1 class="sidebar-header">'+t.title),this.options.closeButton&&(o+='<span class="sidebar-close"><i class="fa fa-caret-left"></i></span>'),t.title&&(o+="</h1>"),i.innerHTML=o+t.pane):(i=t.pane,this._paneContainer.appendChild(i)),i.id=t.id,this._panes.push(i),a=i.querySelectorAll(".sidebar-close"),a.length&&(this._closeButtons.push(a[a.length-1]),this._closeClick(a[a.length-1],"on"))),this._tabClick(e,"on"),this},removePanel:function(t){var i,e,s,a,o;for(i=0;i<this._tabitems.length;i++)if(this._tabitems[i]._id===t){s=this._tabitems[i],this._tabClick(s,"off"),s.remove(),this._tabitems.slice(i,1);break}for(i=0;i<this._panes.length;i++)if(this._panes[i].id===t){for(a=this._panes[i],o=a.querySelectorAll(".sidebar-close"),e=0;i<o.length;i++)this._closeClick(o[e],"off");a.remove(),this._panes.slice(i,1);break}return this},enablePanel:function(t){var i=this._getTab(t);return L.DomUtil.removeClass(i,"disabled"),this},disablePanel:function(t){var i=this._getTab(t);return L.DomUtil.addClass(i,"disabled"),this},_tabClick:function(t,i){var e=t.querySelector("a");if(!e.hasAttribute("href")||"#"===e.getAttribute("href")[0]){var s=function(t){L.DomUtil.hasClass(this,"active")?this._sidebar.close():L.DomUtil.hasClass(this,"disabled")||("string"==typeof this._button?window.location.href=this._button:"function"==typeof this._button?this._button(t):this._sidebar.open(this.querySelector("a").hash.slice(1)))};"on"===i?L.DomEvent.on(t.querySelector("a"),"click",L.DomEvent.preventDefault).on(t.querySelector("a"),"click",s,t):L.DomEvent.off(t.querySelector("a"),"click",s)}},_closeClick:function(t,i){var e=function(){this.close()};"on"===i?L.DomEvent.on(t,"click",e,this):L.DomEvent.off(t,"click",e,this)},_getTab:function(t){for(var i=0;i<this._tabitems.length;i++)if(this._tabitems[i]._id===t)return this._tabitems[i];return null},_panMap:function(t){var i=Number.parseInt(L.DomUtil.getStyle(this._sidebar,"max-width"))/2;("open"===t&&"left"===this.options.position||"close"===t&&"right"===this.options.position)&&(i*=-1),this._map.panBy([i,0],{duration:.5})}}),L.control.sidebar=function(t,i){return new L.Control.Sidebar(t,i)};